
# G2A refund exploit scam

First of all what is G2A?

G2A is a popular online marketplace for digital products such as game keys and software licenses and Bitcoin is one of the payment methods accepted on that platform.

With that being said...

So I found this Google drive document in the wild:
https://drive.google.com/file/d/1Mzn6o3n5xIhN6nueBAl3YTzyb27ZgMrD

Which contains a document about a leaked "exploit" that changes the timezone of the browser so that whenever you make an new order on G2A and as soon as you are redirected
to the payment page the timezone will change which will result in the order
being marked as "Expired" on G2A's payment processor or so they claim...

![1](./Photos/1.png)
![1](./Photos/3.png)
![1](./Photos/4.png)

Now upon reading further it turns out that you need to use their browser extension script in order to achieve what they claim.

![1](./Photos/2.png)

They had the script uploaded to various sources such as catbox.moe and PasteBin, when I opened the paste link it turns out that it contained a heavily obfuscated script

![1](./Photos/5.png)

The script has several obfuscation methods to conceal its true purpose:

1) Heavily Nested and Self-Invoking Functions: Makes the code execution flow difficult to follow.
2) Dynamic Function Names: Uses non-descriptive, randomly generated names for functions and variables.
3) String Encoding: Contains large arrays of encoded strings that are decoded at runtime.
---
After deobfuscating the script

https://github.com/StillAching/Malware-Depot/blob/main/G2A-refund-exploit-scam/g2a_payment_exploit_scam_deobfuscated.js

I found out that it was indeed malicious, heres what I found out:


1) Class Name Patterns: The script looks for elements with class names matching specific patterns such as "indexes__BreakableText" and "indexes__QrCodeImage".

2) Removal of Elements: Removes any alerts or warnings that might indicate to the user that something is not right:

![1](./Photos/6.png)

An array that contains a list of the attacker's BitCoin addresses, These addresses will replace the legitimate payment address on the page of G2A.

![1](./Photos/7.png)

Contains a QR Code Manipulation Function which is responsible for updating the QR code image on the page, it creates a new Image object and once the image loads it replaces the source of the QR code image on the page with the new image URL:

![1](./Photos/8.png)

Generates a new QR code URL with the attacker's Bitcoin address and the transaction amount in the ``c`` function mentioned earlier above:
![1](./Photos/9.png)

Bitcoin Address Replacement: Searches for elements displaying the Bitcoin address and replaces the displayed address with one from the attacker's array ``r``

![1](./Photos/10.png)

extracts the transaction amount from the page content:

![1](./Photos/11.png)

The script sends data to an external server attacker, it sends the transaction amount to a Pipedream endpoint to notify the attacker that a possible victim is about to send funds:

![1](./Photos/12.png)

Encouraging Higher Transactions: Checks if the transaction amount is above a certain threshold

![1](./Photos/13.png)

So in short the script is designed to replace the legitimate Bitcoin payment details on the G2A payment page with the attacker's own Bitcoin addresses by tricking the victims into sending funds to the wrong address.
